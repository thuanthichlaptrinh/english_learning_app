# Card Words API Documentation

## T·ªïng quan

Card Words l√† ·ª©ng d·ª•ng h·ªçc t·ª´ v·ª±ng ti·∫øng Anh v·ªõi c√°c t√≠nh nƒÉng:

-   H·ªá th·ªëng h·ªçc t·ª´ v·ª±ng v·ªõi thu·∫≠t to√°n Spaced Repetition (SM-2)
-   C√°c mini-game h·ªçc t·ª´ v·ª±ng: Quick Quiz, Image Word Matching, Word Definition Matching
-   Flashcard Review v·ªõi h·ªá th·ªëng √¥n t·∫≠p th√¥ng minh
-   Streak tracking v√† leaderboard
-   Offline sync cho mobile app
-   Admin panel qu·∫£n l√Ω t·ª´ v·ª±ng, topics, users

## Tech Stack

-   **Java 17** + Spring Boot 3.2.5
-   **PostgreSQL 16** - Database
-   **Redis 7.x** - Caching
-   **JWT** - Authentication (Access Token + Refresh Token)
-   **Google OAuth2** - Social login
-   **Firebase Storage** - File storage
-   **Flyway** - Database migration
-   **Docker** - Containerization

## Authentication

H·∫ßu h·∫øt c√°c API y√™u c·∫ßu JWT token trong header:

```
Authorization: Bearer <access_token>
```

Admin APIs y√™u c·∫ßu role `ROLE_ADMIN`.

---

## üìö API Endpoints

### 1. Authentication APIs

#### 1.1. ƒêƒÉng k√Ω t√†i kho·∫£n

**POST** `/api/v1/auth/signup`

**Request Body:**

```json
{
    "name": "Nguy·ªÖn VƒÉn A",
    "email": "user@example.com",
    "password": "password123"
}
```

**Response:**

```json
{
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "refresh_token_here",
    "tokenType": "Bearer"
}
```

#### 1.2. ƒêƒÉng nh·∫≠p

**POST** `/api/v1/auth/signin`

**Request Body:**

```json
{
    "email": "user@example.com",
    "password": "password123"
}
```

**Response:** T∆∞∆°ng t·ª± ƒëƒÉng k√Ω

#### 1.3. ƒêƒÉng nh·∫≠p b·∫±ng Google

**POST** `/api/v1/auth/google`

**Request Body:**

```json
{
    "idToken": "google_id_token_here"
}
```

#### 1.4. ƒêƒÉng xu·∫•t

**POST** `/api/v1/auth/signout`

**Headers:** `Authorization: Bearer <token>`

#### 1.5. Qu√™n m·∫≠t kh·∫©u

**POST** `/api/v1/auth/forgot-password`

**Request Body:**

```json
{
    "email": "user@example.com"
}
```

#### 1.6. L√†m m·ªõi access token

**POST** `/api/v1/auth/refresh-token`

**Request Body:**

```json
{
    "refreshToken": "refresh_token_here"
}
```

---

### 2. User Profile APIs

#### 2.1. L·∫•y th√¥ng tin profile

**GET** `/api/v1/users`

**Headers:** `Authorization: Bearer <token>`

**Response:**

```json
{
    "id": 1,
    "name": "Nguy·ªÖn VƒÉn A",
    "email": "user@example.com",
    "avatarUrl": "https://firebase.url/avatar.jpg",
    "gender": "MALE",
    "dateOfBirth": "1990-01-01",
    "currentLevel": "A2"
}
```

#### 2.2. C·∫≠p nh·∫≠t profile

**PUT** `/api/v1/users`

**Headers:** `Authorization: Bearer <token>`

**Request Body:**

```json
{
    "name": "Nguy·ªÖn VƒÉn B",
    "gender": "MALE",
    "dateOfBirth": "1990-01-01",
    "currentLevel": "B1"
}
```

#### 2.3. Upload avatar

**PUT** `/api/v1/users/avatar`

**Headers:**

-   `Authorization: Bearer <token>`
-   `Content-Type: multipart/form-data`

**Form Data:**

-   `file`: Image file

#### 2.4. L·ªãch s·ª≠ ch∆°i game

**GET** `/api/v1/users/games/history`

**Query Params:**

-   `gameId` (optional): ID c·ªßa game
-   `page` (default: 0)
-   `size` (default: 20)

#### 2.5. Th·ªëng k√™ game

**GET** `/api/v1/user/stats/high-scores`

**Response:**

```json
{
    "quickQuiz": 1500,
    "imageWordMatching": 2000,
    "wordDefinitionMatching": 1800
}
```

---

### 3. Vocabulary APIs

#### 3.1. L·∫•y danh s√°ch t·ª´ v·ª±ng

**GET** `/api/v1/vocabs`

**Query Params:**

-   `page` (default: 0)
-   `size` (default: 20)
-   `sortBy` (default: "word")
-   `sortDir` (default: "asc")

#### 3.2. T√¨m ki·∫øm t·ª´ v·ª±ng

**GET** `/api/v1/vocabs/search`

**Query Params:**

-   `keyword`: T·ª´ kh√≥a t√¨m ki·∫øm
-   `page` (default: 0)
-   `size` (default: 20)

#### 3.3. L·∫•y t·ª´ v·ª±ng theo ID

**GET** `/api/v1/vocabs/{id}`

#### 3.4. L·∫•y t·ª´ v·ª±ng theo t·ª´

**GET** `/api/v1/vocabs/word/{word}`

**Example:** `/api/v1/vocabs/word/hello`

#### 3.5. L·∫•y t·ª´ v·ª±ng theo m·ª©c CEFR

**GET** `/api/v1/vocabs/cefr/{cefr}`

**Path Param:**

-   `cefr`: A1, A2, B1, B2, C1, C2

**Query Params:**

-   `page` (default: 0)
-   `size` (default: 20)

#### 3.6. L·∫•y media c·ªßa t·ª´ v·ª±ng

**GET** `/api/v1/vocabs/{id}/media`

**Response:**

```json
{
    "imageUrl": "https://firebase.url/image.jpg",
    "audioUrl": "https://firebase.url/audio.mp3"
}
```

#### 3.7. L·∫•y media theo t·ª´

**GET** `/api/v1/vocabs/word/{word}/media`

---

### 4. Topics APIs

#### 4.1. L·∫•y danh s√°ch ch·ªß ƒë·ªÅ

**GET** `/api/v1/topics`

**Response:**

```json
[
    {
        "id": 1,
        "name": "Animals",
        "description": "ƒê·ªông v·∫≠t",
        "img": "https://firebase.url/topics/animals.jpg"
    }
]
```

#### 4.2. L·∫•y ch·ªß ƒë·ªÅ theo ID

**GET** `/api/v1/topics/{id}`

---

### 5. Types APIs

#### 5.1. L·∫•y danh s√°ch lo·∫°i t·ª´

**GET** `/api/v1/types`

**Response:**

```json
[
    {
        "id": 1,
        "name": "noun",
        "description": "Danh t·ª´"
    },
    {
        "id": 2,
        "name": "verb",
        "description": "ƒê·ªông t·ª´"
    }
]
```

#### 5.2. L·∫•y lo·∫°i t·ª´ theo ID

**GET** `/api/v1/types/{id}`

---

### 6. Learn Vocab APIs

#### 6.1. L·∫•y t·ª´ v·ª±ng ƒë·ªÉ √¥n t·∫≠p

**POST** `/api/v1/learn-vocabs/vocabs/review`

**Request Body:**

```json
{
    "topicName": "Animals",
    "page": 0,
    "size": 20
}
```

#### 6.2. L·∫•y t·ª´ m·ªõi ch∆∞a h·ªçc

**GET** `/api/v1/learn-vocabs/vocabs/new`

**Query Params:**

-   `topicName`: T√™n ch·ªß ƒë·ªÅ
-   `page` (default: 0)
-   `size` (default: 20)

#### 6.3. L·∫•y t·ª´ v·ª±ng theo topic

**GET** `/api/v1/learn-vocabs/topics/{topicName}/vocabs`

**Query Params:**

-   `page` (default: 0)
-   `size` (default: 20)

#### 6.4. Ghi nh·∫≠n k·∫øt qu·∫£ h·ªçc

**POST** `/api/v1/learn-vocabs/submit`

**Request Body:**

```json
{
    "vocabId": 1,
    "isCorrect": true,
    "quality": 4
}
```

**Quality values:**

-   0: Complete blackout
-   1: Incorrect, correct answer seemed familiar
-   2: Incorrect, correct answer seemed easy to recall
-   3: Correct, but required significant effort
-   4: Correct, with some hesitation
-   5: Correct, with perfect recall

#### 6.5. Th·ªëng k√™ ti·∫øn ƒë·ªô h·ªçc

**GET** `/api/v1/learn-vocabs/stats/progress`

**Query Params:**

-   `topicName` (optional): Th·ªëng k√™ theo topic

**Response:**

```json
{
    "totalVocabs": 500,
    "learnedVocabs": 120,
    "masteredVocabs": 50,
    "reviewingVocabs": 70,
    "newVocabs": 380
}
```

---

### 7. Flashcard Review APIs

#### 7.1. L·∫•y flashcards c·∫ßn √¥n h√¥m nay

**GET** `/api/v1/flashcard-review/due`

**Query Params:**

-   `limit` (optional): S·ªë l∆∞·ª£ng flashcards

**Response:**

```json
[
    {
        "vocabId": 1,
        "word": "hello",
        "definition": "xin ch√†o",
        "nextReview": "2024-01-15T10:00:00"
    }
]
```

#### 7.2. L·∫•y th√¥ng tin m·ªôt flashcard

**GET** `/api/v1/flashcard-review/vocabs/{vocabId}`

#### 7.3. Ghi nh·∫≠n k·∫øt qu·∫£ √¥n t·∫≠p

**POST** `/api/v1/flashcard-review/submit`

**Request Body:**

```json
{
    "vocabId": 1,
    "quality": 4
}
```

**Quality:** 0-5 (theo thu·∫≠t to√°n SM-2)

#### 7.4. Th·ªëng k√™ √¥n t·∫≠p h√¥m nay

**GET** `/api/v1/flashcard-review/stats/today`

**Response:**

```json
{
    "totalDue": 15,
    "reviewed": 10,
    "remaining": 5
}
```

---

### 8. Quick Quiz Game APIs

#### 8.1. L·∫•y h∆∞·ªõng d·∫´n ch∆°i

**GET** `/api/v1/games/quick-quiz/instructions`

**Public API** (kh√¥ng c·∫ßn token)

#### 8.2. B·∫Øt ƒë·∫ßu game

**POST** `/api/v1/games/quick-quiz/start`

**Request Body:**

```json
{
    "topicName": "Animals",
    "difficulty": "EASY",
    "numberOfQuestions": 10
}
```

**Response:**

```json
{
    "sessionId": "uuid-here",
    "questions": [
        {
            "questionId": 1,
            "word": "hello",
            "options": ["xin ch√†o", "t·∫°m bi·ªát", "c·∫£m ∆°n", "xin l·ªói"],
            "timeLimit": 15
        }
    ]
}
```

#### 8.3. Tr·∫£ l·ªùi c√¢u h·ªèi

**POST** `/api/v1/games/quick-quiz/answer`

**Request Body:**

```json
{
    "sessionId": "uuid-here",
    "questionId": 1,
    "selectedAnswer": "xin ch√†o",
    "timeSpent": 8
}
```

#### 8.4. B·ªè qua c√¢u h·ªèi (timeout)

**POST** `/api/v1/games/quick-quiz/skip`

**Request Body:**

```json
{
    "sessionId": "uuid-here",
    "questionId": 1
}
```

#### 8.5. Xem k·∫øt qu·∫£ game

**GET** `/api/v1/games/quick-quiz/sessions/{sessionId}`

**Response:**

```json
{
    "sessionId": "uuid-here",
    "totalQuestions": 10,
    "correctAnswers": 8,
    "score": 1200,
    "accuracy": 80.0,
    "completedAt": "2024-01-15T10:30:00"
}
```

#### 8.6. B·∫£ng x·∫øp h·∫°ng

**GET** `/api/v1/games/quick-quiz/leaderboard`

**Query Params:**

-   `limit` (default: 10)

---

### 9. Image Word Matching Game APIs

#### 9.1. L·∫•y h∆∞·ªõng d·∫´n ch∆°i

**GET** `/api/v1/games/image-word-matching/instructions`

**Public API**

#### 9.2. B·∫Øt ƒë·∫ßu game

**POST** `/api/v1/games/image-word-matching/start`

**Request Body:**

```json
{
    "topicName": "Animals",
    "difficulty": "MEDIUM",
    "numberOfPairs": 6
}
```

**Response:**

```json
{
    "sessionId": "uuid-here",
    "pairs": [
        {
            "imageUrl": "https://firebase.url/cat.jpg",
            "word": "cat"
        }
    ],
    "timeLimit": 60
}
```

#### 9.3. N·ªôp k·∫øt qu·∫£

**POST** `/api/v1/games/image-word-matching/submit`

**Request Body:**

```json
{
    "sessionId": "uuid-here",
    "matches": [
        {
            "imageIndex": 0,
            "wordIndex": 2
        }
    ],
    "timeSpent": 45
}
```

#### 9.4. L·∫•y th√¥ng tin session

**GET** `/api/v1/games/image-word-matching/sessions/{sessionId}`

#### 9.5. L·ªãch s·ª≠ ch∆°i

**GET** `/api/v1/games/image-word-matching/history`

**Query Params:**

-   `page` (default: 0)
-   `size` (default: 20)

#### 9.6. B·∫£ng x·∫øp h·∫°ng

**GET** `/api/v1/games/image-word-matching/leaderboard`

**Query Params:**

-   `limit` (default: 10)

#### 9.7. Th·ªëng k√™ c√° nh√¢n

**GET** `/api/v1/games/image-word-matching/stats`

---

### 10. Word Definition Matching Game APIs

#### 10.1. L·∫•y h∆∞·ªõng d·∫´n ch∆°i

**GET** `/api/v1/games/word-definition-matching/instructions`

**Public API**

#### 10.2. B·∫Øt ƒë·∫ßu game

**POST** `/api/v1/games/word-definition-matching/start`

**Request Body:**

```json
{
    "topicName": "Food",
    "difficulty": "HARD",
    "numberOfPairs": 8
}
```

#### 10.3. N·ªôp k·∫øt qu·∫£

**POST** `/api/v1/games/word-definition-matching/submit`

**Request Body:**

```json
{
    "sessionId": "uuid-here",
    "matches": [
        {
            "wordIndex": 0,
            "definitionIndex": 3
        }
    ],
    "timeSpent": 50
}
```

#### 10.4. L·∫•y th√¥ng tin session

**GET** `/api/v1/games/word-definition-matching/sessions/{sessionId}`

#### 10.5. B·∫£ng x·∫øp h·∫°ng

**GET** `/api/v1/games/word-definition-matching/leaderboard`

**Query Params:**

-   `limit` (default: 10)

---

### 11. User Vocab Progress APIs

#### 11.1. L·∫•y t·∫•t c·∫£ t·ª´ ƒë√£ h·ªçc

**GET** `/api/v1/user-vocab-progress`

#### 11.2. L·∫•y t·ª´ tr·∫£ l·ªùi ƒë√∫ng

**GET** `/api/v1/user-vocab-progress/correct`

#### 11.3. L·∫•y t·ª´ tr·∫£ l·ªùi sai

**GET** `/api/v1/user-vocab-progress/wrong`

#### 11.4. Th·ªëng k√™ ti·∫øn tr√¨nh h·ªçc

**GET** `/api/v1/user-vocab-progress/stats`

**Response:**

```json
{
    "totalLearned": 150,
    "mastered": 80,
    "reviewing": 50,
    "struggling": 20
}
```

#### 11.5. T·ª´ c·∫ßn √¥n t·∫≠p h√¥m nay

**GET** `/api/v1/user-vocab-progress/due-for-review`

#### 11.6. T·ª´ ƒë√£ h·ªçc trong ng√†y

**GET** `/api/v1/user-vocab-progress/learned-today`

#### 11.7. Th·ªëng k√™ 7 ng√†y g·∫ßn nh·∫•t

**GET** `/api/v1/user-vocab-progress/stats/last-7-days`

**Response:**

```json
[
    {
        "date": "2024-01-15",
        "wordsLearned": 10
    }
]
```

#### 11.8. Th·ªëng k√™ theo CEFR

**GET** `/api/v1/user-vocab-progress/stats/by-cefr`

**Response:**

```json
{
    "A1": 50,
    "A2": 40,
    "B1": 30,
    "B2": 20,
    "C1": 10,
    "C2": 0
}
```

---

### 12. Streak APIs

#### 12.1. L·∫•y th√¥ng tin streak

**GET** `/api/v1/user/streak`

**Response:**

```json
{
    "currentStreak": 7,
    "longestStreak": 15,
    "lastActivityDate": "2024-01-15"
}
```

#### 12.2. Ghi nh·∫≠n ho·∫°t ƒë·ªông h·ªçc

**POST** `/api/v1/user/streak/record`

T·ª± ƒë·ªông c·∫≠p nh·∫≠t streak khi user h·ªçc b√†i

---

### 13. Leaderboard APIs

#### 13.1. Top 10 players t·ªïng h·ª£p

**GET** `/api/v1/leaderboard/top-players`

#### 13.2. B·∫£ng x·∫øp h·∫°ng Quick Quiz to√†n c·∫ßu

**GET** `/api/v1/leaderboard/quiz/global`

**Query Params:**

-   `limit` (default: 10)

#### 13.3. B·∫£ng x·∫øp h·∫°ng Quick Quiz theo ng√†y

**GET** `/api/v1/leaderboard/quiz/daily`

**Query Params:**

-   `date`: yyyy-MM-dd
-   `limit` (default: 10)

#### 13.4. X·∫øp h·∫°ng c·ªßa t√¥i trong Quick Quiz

**GET** `/api/v1/leaderboard/quiz/my-rank`

#### 13.5. B·∫£ng x·∫øp h·∫°ng streak hi·ªán t·∫°i

**GET** `/api/v1/leaderboard/streak/current`

**Query Params:**

-   `limit` (default: 10)

#### 13.6. B·∫£ng x·∫øp h·∫°ng streak t·ªët nh·∫•t

**GET** `/api/v1/leaderboard/streak/best`

**Query Params:**

-   `limit` (default: 10)

#### 13.7. B·∫£ng x·∫øp h·∫°ng Image Matching

**GET** `/api/v1/leaderboard/image-matching`

**Query Params:**

-   `limit` (default: 10)

#### 13.8. B·∫£ng x·∫øp h·∫°ng Word Definition

**GET** `/api/v1/leaderboard/word-definition`

**Query Params:**

-   `limit` (default: 10)

---

### 14. Offline Sync APIs

#### 14.1. Download APIs

##### 14.1.1. L·∫•y danh s√°ch topics v·ªõi ti·∫øn ƒë·ªô

**GET** `/api/v1/offline/topics`

##### 14.1.2. Download t·ª´ v·ª±ng c·ªßa topic

**GET** `/api/v1/offline/topics/{topicId}/vocabs`

##### 14.1.3. L·∫•y t·ª´ h·ªçc g·∫ßn ƒë√¢y (30 ng√†y)

**GET** `/api/v1/offline/vocabs/recent`

##### 14.1.4. Ki·ªÉm tra c·∫≠p nh·∫≠t

**GET** `/api/v1/offline/check-updates`

**Query Params:**

-   `lastSyncTime`: ISO timestamp

#### 14.2. Upload APIs

##### 14.2.1. Batch upload t·∫•t c·∫£

**POST** `/api/v1/offline/sync/batch`

**Request Body:**

```json
{
  "gameSessions": [...],
  "vocabProgress": [...]
}
```

##### 14.2.2. Upload game sessions

**POST** `/api/v1/offline/game-sessions`

**Request Body:**

```json
[
    {
        "sessionId": "offline-uuid",
        "gameId": 1,
        "score": 1500,
        "completedAt": "2024-01-15T10:30:00"
    }
]
```

##### 14.2.3. Upload learning progress

**POST** `/api/v1/offline/user-vocab-progress`

**Request Body:**

```json
[
    {
        "vocabId": 1,
        "isCorrect": true,
        "learnedAt": "2024-01-15T10:00:00"
    }
]
```

##### 14.2.4. Upload game details

**POST** `/api/v1/offline/game-sessions/{sessionId}/details`

**Request Body:**

```json
[
    {
        "questionId": 1,
        "isCorrect": true,
        "timeSpent": 10
    }
]
```

---

## üîê Admin APIs

**T·∫•t c·∫£ Admin APIs y√™u c·∫ßu role `ROLE_ADMIN`**

### 15. Vocab Admin APIs

#### 15.1. L·∫•y t·ª´ v·ª±ng theo ID

**GET** `/api/v1/admin/vocabs/{id}`

#### 15.2. L·∫•y t·ª´ v·ª±ng theo t·ª´

**GET** `/api/v1/admin/vocabs/word/{word}`

#### 15.3. L·∫•y danh s√°ch t·ª´ v·ª±ng

**GET** `/api/v1/admin/vocabs`

**Query Params:**

-   `page`, `size`, `sortBy`, `sortDir`

#### 15.4. T√¨m ki·∫øm t·ª´ v·ª±ng

**GET** `/api/v1/admin/vocabs/search`

**Query Params:**

-   `keyword`, `page`, `size`

#### 15.5. L·∫•y t·ª´ v·ª±ng theo CEFR

**GET** `/api/v1/admin/vocabs/cefr/{cefr}`

#### 15.6. Th√™m t·ª´ v·ª±ng m·ªõi

**POST** `/api/v1/admin/vocabs`

**Request Body:**

```json
{
    "word": "hello",
    "definition": "xin ch√†o",
    "pronunciation": "/h…ôÀàlo ä/",
    "example": "Hello, how are you?",
    "cefr": "A1",
    "topicId": 1,
    "typeId": 1,
    "imageUrl": "https://...",
    "audioUrl": "https://..."
}
```

#### 15.7. Th√™m h√†ng lo·∫°t t·ª´ v·ª±ng

**POST** `/api/v1/admin/vocabs/bulk-import`

**Request Body:**

```json
{
  "vocabs": [
    {
      "word": "hello",
      "definition": "xin ch√†o",
      ...
    }
  ]
}
```

#### 15.8. C·∫≠p nh·∫≠t t·ª´ v·ª±ng theo ID

**PUT** `/api/v1/admin/vocabs/{id}`

#### 15.9. C·∫≠p nh·∫≠t t·ª´ v·ª±ng theo t·ª´

**PUT** `/api/v1/admin/vocabs/word/{word}`

#### 15.10. X√≥a t·ª´ v·ª±ng

**DELETE** `/api/v1/admin/vocabs/{id}`

#### 15.11. Xu·∫•t Excel

**GET** `/api/v1/admin/vocabs/export/excel`

---

### 16. Topic Admin APIs

#### 16.1. L·∫•y danh s√°ch ch·ªß ƒë·ªÅ

**GET** `/api/v1/admin/topics`

#### 16.2. L·∫•y ch·ªß ƒë·ªÅ theo ID

**GET** `/api/v1/admin/topics/{id}`

#### 16.3. T·∫°o ch·ªß ƒë·ªÅ m·ªõi

**POST** `/api/v1/admin/topics`

**Headers:** `Content-Type: multipart/form-data`

**Form Data:**

-   `name`: T√™n ch·ªß ƒë·ªÅ (required)
-   `description`: M√¥ t·∫£
-   `image`: File ·∫£nh

**Response:**

```json
{
    "id": 1,
    "name": "Animals",
    "description": "ƒê·ªông v·∫≠t",
    "img": "https://firebase.url/topics/images/uuid.jpg"
}
```

#### 16.4. C·∫≠p nh·∫≠t ch·ªß ƒë·ªÅ

**PUT** `/api/v1/admin/topics/{id}`

**Headers:** `Content-Type: multipart/form-data`

**Form Data:**

-   `name`: T√™n m·ªõi (optional)
-   `description`: M√¥ t·∫£ m·ªõi (optional)
-   `image`: File ·∫£nh m·ªõi (optional)

**L∆∞u √Ω:** Ch·ªâ c·∫≠p nh·∫≠t c√°c tr∆∞·ªùng ƒë∆∞·ª£c cung c·∫•p

#### 16.5. X√≥a ch·ªß ƒë·ªÅ

**DELETE** `/api/v1/admin/topics/{id}`

#### 16.6. T·∫°o nhi·ªÅu ch·ªß ƒë·ªÅ c√πng l√∫c

**POST** `/api/v1/admin/topics/bulk-create`

**Request Body:**

```json
{
    "topics": [
        {
            "name": "Animals",
            "description": "ƒê·ªông v·∫≠t",
            "imageUrl": "https://..."
        },
        {
            "name": "Food",
            "description": "Th·ª©c ƒÉn"
        }
    ]
}
```

**Response:**

```json
{
    "totalRequested": 2,
    "successCount": 2,
    "failureCount": 0,
    "results": [
        {
            "success": true,
            "topic": {
                "id": 1,
                "name": "Animals",
                "description": "ƒê·ªông v·∫≠t",
                "img": "https://..."
            }
        }
    ]
}
```

#### 16.7. C·∫≠p nh·∫≠t nhi·ªÅu ch·ªß ƒë·ªÅ c√πng l√∫c

**PUT** `/api/v1/admin/topics/bulk-update`

**Request Body:**

```json
{
    "topics": [
        {
            "id": 1,
            "name": "Wild Animals",
            "description": "ƒê·ªông v·∫≠t hoang d√£"
        },
        {
            "id": 2,
            "imageUrl": "https://new-image-url"
        }
    ]
}
```

**L∆∞u √Ω:** M·ªói topic ch·ªâ c·∫≠p nh·∫≠t c√°c tr∆∞·ªùng ƒë∆∞·ª£c cung c·∫•p

---

### 17. Type Admin APIs

#### 17.1. L·∫•y danh s√°ch lo·∫°i t·ª´

**GET** `/api/v1/admin/types`

#### 17.2. L·∫•y lo·∫°i t·ª´ theo ID

**GET** `/api/v1/admin/types/{id}`

#### 17.3. T·∫°o lo·∫°i t·ª´ m·ªõi

**POST** `/api/v1/admin/types`

**Request Body:**

```json
{
    "name": "adjective",
    "description": "T√≠nh t·ª´"
}
```

#### 17.4. X√≥a lo·∫°i t·ª´

**DELETE** `/api/v1/admin/types/{id}`

---

### 18. User Admin APIs

#### 18.1. L·∫•y danh s√°ch ng∆∞·ªùi d√πng

**GET** `/api/v1/admin/users`

**Query Params:**

-   `page`, `size`, `sortBy`, `sortDir`

#### 18.2. L·∫•y user theo ID

**GET** `/api/v1/admin/users/{id}`

#### 18.3. L·∫•y user theo email

**GET** `/api/v1/admin/users/email/{email}`

#### 18.4. T√¨m ki·∫øm ng∆∞·ªùi d√πng

**GET** `/api/v1/admin/users/search`

**Query Params:**

-   `keyword`, `page`, `size`

#### 18.5. Kh√≥a/m·ªü kh√≥a t√†i kho·∫£n

**PUT** `/api/v1/admin/users/{id}/ban`

**Query Params:**

-   `banned`: true/false

#### 18.6. K√≠ch ho·∫°t/v√¥ hi·ªáu h√≥a t√†i kho·∫£n

**PUT** `/api/v1/admin/users/{id}/activate`

**Query Params:**

-   `activated`: true/false

#### 18.7. C·∫≠p nh·∫≠t role

**PUT** `/api/v1/admin/users/{id}/roles`

**Request Body:**

```json
{
    "roles": ["ROLE_USER", "ROLE_ADMIN"]
}
```

#### 18.8. X√≥a ng∆∞·ªùi d√πng

**DELETE** `/api/v1/admin/users/{id}`

#### 18.9. Th·ªëng k√™ ng∆∞·ªùi d√πng

**GET** `/api/v1/admin/users/statistics`

**Response:**

```json
{
    "totalUsers": 1000,
    "activeUsers": 800,
    "bannedUsers": 50,
    "newUsersThisMonth": 120
}
```

---

### 19. Vocab Progress Admin APIs

#### 19.1. L·∫•y ti·∫øn ƒë·ªô h·ªçc t·ª´ c·ªßa user

**GET** `/api/v1/admin/vocab-progress/user/{userId}`

**Query Params:**

-   `page`, `size`

#### 19.2. Th·ªëng k√™ t·ª´ v·ª±ng

**GET** `/api/v1/admin/vocab-progress/vocab/{vocabId}/stats`

**Response:**

```json
{
    "totalLearners": 500,
    "masteredCount": 200,
    "averageAttempts": 3.5
}
```

#### 19.3. T·ªïng quan ti·∫øn ƒë·ªô h·ªçc

**GET** `/api/v1/admin/vocab-progress/statistics`

#### 19.4. Danh s√°ch t·ª´ kh√≥ nh·∫•t

**GET** `/api/v1/admin/vocab-progress/difficult-words`

**Query Params:**

-   `limit` (default: 10)

#### 19.5. X√≥a b·∫£n ghi ti·∫øn ƒë·ªô

**DELETE** `/api/v1/admin/vocab-progress/{id}`

#### 19.6. Reset to√†n b·ªô ti·∫øn ƒë·ªô c·ªßa user

**DELETE** `/api/v1/admin/vocab-progress/user/{userId}/reset`

---

### 20. Game Admin APIs

#### 20.1. L·∫•y danh s√°ch game

**GET** `/api/v1/admin/games`

#### 20.2. L·∫•y th√¥ng tin game theo ID

**GET** `/api/v1/admin/games/{id}`

#### 20.3. L·∫•y danh s√°ch session c·ªßa game

**GET** `/api/v1/admin/games/{id}/sessions`

**Query Params:**

-   `page`, `size`

#### 20.4. L·∫•y chi ti·∫øt session

**GET** `/api/v1/admin/games/sessions/{sessionId}`

#### 20.5. Th·ªëng k√™ game

**GET** `/api/v1/admin/games/{id}/statistics`

#### 20.6. T·ªïng quan th·ªëng k√™ t·∫•t c·∫£ game

**GET** `/api/v1/admin/games/statistics/overview`

#### 20.7. X√≥a session

**DELETE** `/api/v1/admin/games/sessions/{sessionId}`

---

### 21. Firebase Storage APIs

#### 21.1. Upload ·∫£nh

**POST** `/api/v1/storage/upload/image`

**Headers:** `Content-Type: multipart/form-data`

**Form Data:**

-   `file`: Image file

**Response:**

```json
{
    "url": "https://firebase.url/image.jpg"
}
```

#### 21.2. Upload audio

**POST** `/api/v1/storage/upload/audio`

**Headers:** `Content-Type: multipart/form-data`

**Form Data:**

-   `file`: Audio file

#### 21.3. Upload nhi·ªÅu ·∫£nh

**POST** `/api/v1/storage/upload/images/bulk`

**Headers:** `Content-Type: multipart/form-data`

**Form Data:**

-   `files[]`: Array of image files

**Response:**

```json
{
    "urls": ["https://firebase.url/image1.jpg", "https://firebase.url/image2.jpg"]
}
```

#### 21.4. Upload nhi·ªÅu audio

**POST** `/api/v1/storage/upload/audios/bulk`

**Headers:** `Content-Type: multipart/form-data`

**Form Data:**

-   `files[]`: Array of audio files

#### 21.5. Upload media v√† c·∫≠p nh·∫≠t vocab

**POST** `/api/v1/storage/upload/vocab-media/{vocabId}`

**Headers:** `Content-Type: multipart/form-data`

**Form Data:**

-   `files[]`: Image v√† audio files

#### 21.6. D·ªçn d·∫πp audio kh√¥ng s·ª≠ d·ª•ng

**POST** `/api/v1/storage/cleanup/audios`

**Query Params:**

-   `dryRun`: true/false (preview mode)

#### 21.7. D·ªçn d·∫πp image kh√¥ng s·ª≠ d·ª•ng

**POST** `/api/v1/storage/cleanup/images`

**Query Params:**

-   `dryRun`: true/false

#### 21.8. X√≥a file

**DELETE** `/api/v1/storage/delete`

**Query Params:**

-   `url`: Firebase Storage URL

---

## üìä T·ªïng k·∫øt

-   **T·ªïng s·ªë Controllers:** 22
-   **Public APIs:** 7 endpoints (Authentication + Game instructions)
-   **User APIs:** ~80 endpoints (y√™u c·∫ßu Bearer Token)
-   **Admin APIs:** ~60 endpoints (y√™u c·∫ßu ROLE_ADMIN)
-   **T·ªïng s·ªë endpoints:** ~147 APIs

---

## üöÄ Getting Started

### Prerequisites

-   Java 17+
-   Maven 3.6+
-   Docker & Docker Compose
-   PostgreSQL 16
-   Redis

### Running with Docker

```bash
# Build v√† ch·∫°y t·∫•t c·∫£ services
./docker-deploy.bat  # Windows
./docker-deploy.sh   # Linux/Mac

# ·ª®ng d·ª•ng s·∫Ω ch·∫°y t·∫°i http://localhost:8080
```

### Running locally

```bash
# Install dependencies
mvn clean install

# Run application
mvn spring-boot:run
```

---

## üìù API Testing

### Using cURL

```bash
# ƒêƒÉng k√Ω
curl -X POST http://localhost:8080/api/v1/auth/signup \
  -H "Content-Type: application/json" \
  -d '{"name":"Test User","email":"test@example.com","password":"password123"}'

# ƒêƒÉng nh·∫≠p
curl -X POST http://localhost:8080/api/v1/auth/signin \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123"}'

# L·∫•y profile (v·ªõi token)
curl -X GET http://localhost:8080/api/v1/users \
  -H "Authorization: Bearer <your_token>"
```

### Using PowerShell

Xem c√°c test scripts trong th∆∞ m·ª•c g·ªëc:

-   `test-topic-image-api.ps1`
-   `test-bulk-topics.ps1`
-   Redis Sorted Sets (O(log N) performance)

### 6. Redis Caching

-   **Phase 1**: User caching (email lookup, profiles, online tracking)
-   **Phase 2**: Game sessions (Quiz, Image Matching, Word Definition)
-   **Phase 3**: Leaderboards (Global, Daily, Weekly)
-   Performance: 50-200x faster than database queries

## Prerequisites

-   **Java 17+**
-   **Maven 3.8+**
-   **PostgreSQL 15+**
-   **Redis 7+** (or Docker)
-   **Docker & Docker Compose** (optional but recommended)

## Installation & Setup

### 1. Clone Repository

```bash
git clone https://github.com/thuanthichlaptrinh/card_words.git
cd card_words
```

### 2. Configure Environment

Copy file `.env.docker.example` thanh `.env` va cap nhat cac bien:

```bash
# Database
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=card_words
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_password

# JWT
JWT_SECRET=your_jwt_secret_key_min_256_bits
JWT_EXPIRATION=86400000

# Google OAuth2
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379

# Firebase (for file storage)
FIREBASE_BUCKET=your_firebase_bucket
```

### 3. Setup Database

**Option A: PostgreSQL local**

```bash
# Tao database
psql -U postgres
CREATE DATABASE card_words;
\q

# Flyway se tu dong chay migrations khi start app
```

**Option B: PostgreSQL Docker**

```bash
docker-compose up -d postgres
```

### 4. Setup Redis

**Option A: Redis Docker (Recommended)**

```bash
docker-compose up -d redis
```

**Option B: Redis local**

```bash
# Windows (with Chocolatey)
choco install redis

# Mac
brew install redis
brew services start redis

# Linux
sudo apt-get install redis-server
sudo systemctl start redis
```

### 5. Build & Run Application

**Option A: Maven Wrapper**

```bash
# Build
./mvnw clean install -DskipTests

# Run
./mvnw spring-boot:run
```

\*\*Option B: Maven (neu da cai)

```bash
mvn clean install -DskipTests
mvn spring-boot:run
```

**Option C: Docker Compose (Full stack)**

```bash
# Build va start TAT CA 3 services:
# 1. PostgreSQL (port 5432)
# 2. Redis (port 6379)
# 3. Spring Boot App (port 8080)
docker-compose up -d

# Xem logs cua ung dung
docker-compose logs -f app

# Xem logs tat ca services
docker-compose logs -f

# Stop tat ca services
docker-compose down

# Stop va xoa volumes (database data)
docker-compose down -v
```

### 6. Verify Application

Ung dung se chay o: **http://localhost:8080**

**Health Check**:

```bash
curl http://localhost:8080/actuator/health
```

**Swagger UI** (API Documentation):

```
http://localhost:8080/swagger-ui.html
```

---

## Docker Compose Services

Khi chay `docker-compose up -d`, cac services sau se duoc khoi dong:

### 1. PostgreSQL Database

-   **Container**: `card-words-postgres`
-   **Image**: `postgres:16-alpine`
-   **Port**: `5432` (mapped to host)
-   **Volume**: `postgres_data` (luu du lieu database)
-   **Health Check**: Ping PostgreSQL moi 10s
-   **Init Script**: `init-db.sql` (tu dong chay khi lan dau)

### 2. Redis Cache

-   **Container**: `card-words-redis`
-   **Image**: `redis:7-alpine`
-   **Port**: `6379` (mapped to host)
-   **Volume**: `redis_data` (luu AOF file)
-   **Health Check**: Redis PING command
-   **Persistence**: AOF (Append-Only File) enabled

### 3. Spring Boot Application

-   **Container**: `card-words-app`

---

## üìñ Additional Documentation

Xem th√™m t√†i li·ªáu chi ti·∫øt trong th∆∞ m·ª•c `/docs`:

-   **Redis**: `redis/REDIS_QUICK_START.md` - H∆∞·ªõng d·∫´n Redis caching
-   **Flashcard**: `flash_card/FLASHCARD_REVIEW_API_GUIDE.md` - Chi ti·∫øt Flashcard APIs
-   **Games**: `game/GAME_ALGORITHMS_DESIGN.md` - Thu·∫≠t to√°n t√≠nh ƒëi·ªÉm game
-   **Streak**: `streak/STREAK_FEATURE_COMPLETED.md` - Streak tracking system
-   **Docker**: `docker/DOCKER_DATABASE_INDEX.md` - Docker & Database setup
-   **Learn Vocab**: `learn/LEARN_VOCAB_API_GUIDE.md` - Learn vocabulary APIs
-   **Quick Quiz**: `quick_quiz/QUICK_QUIZ_API_GUIDE.md` - Quick Quiz game guide
-   **Image Matching**: `image_word/IMAGE_WORD_MATCHING_GUIDE.md` - Image matching game
-   **Vocab Status**: `vocab/VOCAB_STATUS_IMPLEMENTATION_SUMMARY.md` - Vocabulary management

---

## üê≥ Docker Architecture

### Container Structure

```
card-words-network
‚îú‚îÄ‚îÄ postgres:16      (port 5433:5432)
‚îú‚îÄ‚îÄ redis:7-alpine   (port 6380:6379)
‚îî‚îÄ‚îÄ card-words-app   (port 8080:8080)
```

### Service Configuration

#### PostgreSQL

-   **Image**: `postgres:16-alpine`
-   **Port**: `5433` (host) ‚Üí `5432` (container)
-   **Database**: `card_words`
-   **User**: `admin` / Password: t·ª´ `.env.docker`
-   **Volumes**: `postgres-data` (persistent storage)
-   **Health Check**: `pg_isready` m·ªói 10s

#### Redis

-   **Image**: `redis:7-alpine`
-   **Port**: `6380` (host) ‚Üí `6379` (container)
-   **Password**: C·∫•u h√¨nh trong `.env.docker`
-   **Volumes**: `redis-data` (persistent storage)
-   **Health Check**: `redis-cli ping` m·ªói 10s

#### Spring Boot App

-   **Build**: T·ª´ Dockerfile trong project
-   **Port**: `8080` (mapped to host)
-   **Dependencies**: ƒê·ª£i PostgreSQL v√† Redis healthy tr∆∞·ªõc khi start
-   **Restart**: Automatic (unless-stopped)
-   **Environment**: ƒê·ªçc t·ª´ file `.env.docker`

### Service Dependencies

```
Spring Boot App
    ‚îú‚îÄ‚îÄ depends_on: PostgreSQL (healthy)
    ‚îî‚îÄ‚îÄ depends_on: Redis (healthy)
```

**Ch√∫ √Ω**: App ch·ªâ start sau khi PostgreSQL v√† Redis ƒë√£ HEALTHY

---

## ‚ö° Quick Start Commands

### Development Mode

```bash
# 1. Start Redis
docker-compose up -d redis

# 2. Start PostgreSQL (n·∫øu d√πng Docker)
docker-compose up -d postgres

# 3. Run Spring Boot
./mvnw spring-boot:run

# 4. Xem logs
tail -f app.log
```

### Production Build

```bash
# Build JAR
./mvnw clean package -DskipTests

# Run JAR
java -jar target/card-words-0.0.1-SNAPSHOT.jar
```

### Docker Commands

```bash
# Build image
docker build -t card-words:latest .

# Run container
docker run -d -p 8080:8080 --name card-words card-words:latest

# Stop container
docker stop card-words
docker rm card-words
```

### Docker Compose Commands

```bash
# Start t·∫•t c·∫£ services (detached mode)
docker-compose up -d

# Start ch·ªâ Redis v√† Postgres (kh√¥ng start app)
docker-compose up -d redis postgres

# Xem status c√°c services
docker-compose ps

# Xem logs realtime
docker-compose logs -f

# Xem logs m·ªôt service c·ª• th·ªÉ
docker-compose logs -f app
docker-compose logs -f redis
docker-compose logs -f postgres

# Restart m·ªôt service
docker-compose restart app

# Stop t·∫•t c·∫£ services
docker-compose stop

# Stop v√† x√≥a containers (GI·ªÆ d·ªØ li·ªáu volumes)
docker-compose down

# Stop, x√≥a containers V√Ä volumes (M·∫§T d·ªØ li·ªáu database)
docker-compose down -v

# Rebuild image v√† restart
docker-compose up -d --build

# Ki·ªÉm tra health status
docker-compose ps
docker inspect card-words-postgres | grep -A 5 Health
docker inspect card-words-redis | grep -A 5 Health
```

---

## üìÑ License

Copyright ¬© 2024 Card Words Project

## API Endpoints

### Authentication

```
POST   /api/v1/auth/register          - Dang ky tai khoan
POST   /api/v1/auth/login             - Dang nhap
POST   /api/v1/auth/google            - Dang nhap Google OAuth2
POST   /api/v1/auth/refresh-token     - Refresh JWT token
POST   /api/v1/auth/logout            - Dang xuat
```

### Vocabulary

```
GET    /api/v1/vocabs                 - Lay danh sach tu vung
GET    /api/v1/vocabs/{id}            - Chi tiet tu vung
POST   /api/v1/vocabs                 - Them tu vung (Admin)
PUT    /api/v1/vocabs/{id}            - Cap nhat tu vung (Admin)
DELETE /api/v1/vocabs/{id}            - Xoa tu vung (Admin)
```

### Learning

```
GET    /api/v1/learn/review-vocabs    - Lay tu can on tap
POST   /api/v1/learn/review           - Danh gia ket qua on tap
GET    /api/v1/learn/flashcards       - Lay flashcards
POST   /api/v1/learn/flashcard-review - Danh gia flashcard
GET    /api/v1/learn/stats            - Thong ke hoc tap
```

### Games

```
POST   /api/v1/games/quick-quiz/start    - Bat dau Quick Quiz
POST   /api/v1/games/quick-quiz/answer   - Tra loi cau hoi
POST   /api/v1/games/quick-quiz/skip     - Bo qua cau hoi
GET    /api/v1/games/quick-quiz/results  - Ket qua game

POST   /api/v1/games/image-matching/start
POST   /api/v1/games/image-matching/answer

POST   /api/v1/games/word-definition/start
POST   /api/v1/games/word-definition/answer
```

### Leaderboard (Phase 3)

```
GET    /api/v1/leaderboard/quiz/global       - Bang xep hang toan cau
GET    /api/v1/leaderboard/quiz/daily        - Bang xep hang theo ngay
GET    /api/v1/leaderboard/quiz/my-rank      - Xep hang cua toi
GET    /api/v1/leaderboard/streak/current    - Bang xep hang streak
GET    /api/v1/leaderboard/streak/best       - Bang xep hang streak tot nhat
GET    /api/v1/leaderboard/image-matching    - Image Matching leaderboard
GET    /api/v1/leaderboard/word-definition   - Word Definition leaderboard
```

### Streak

```
GET    /api/v1/streak                 - Lay thong tin streak
POST   /api/v1/streak/check-in        - Check-in hang ngay
```

### User Stats

```
GET    /api/v1/users/stats            - Thong ke nguoi dung
GET    /api/v1/users/profile          - Thong tin ca nhan
PUT    /api/v1/users/profile          - Cap nhat thong tin
```

## Testing

### Run Tests

```bash
# Run tat ca tests
./mvnw test

# Run mot test class
./mvnw test -Dtest=QuickQuizServiceTest

# Skip tests khi build
./mvnw clean install -DskipTests
```

### Test Coverage

```bash
./mvnw jacoco:report
```

## Redis Utilities

### Check Redis Connection

```bash
# Linux/Mac
./check-redis-keys.sh

# Windows
check-redis-keys.bat
```

### Redis CLI Commands

```bash
# Connect to Redis
docker exec -it card-words-redis redis-cli

# List all keys
KEYS cardwords:*

# Check leaderboard
ZREVRANGE cardwords:leaderboard:quickquiz:global 0 9 WITHSCORES

# Get user rank
ZRANK cardwords:leaderboard:quickquiz:global "user-uuid"

# Check cache TTL
TTL cardwords:user:email:test@example.com
```

## Performance Optimization

### Redis Caching Benefits

| Operation                   | Without Redis | With Redis | Improvement    |
| --------------------------- | ------------- | ---------- | -------------- |
| User Login                  | 100ms         | 5ms        | 95% faster     |
| Leaderboard Query (Top 100) | 500-1000ms    | 5-10ms     | 50-200x faster |
| Game Session Load           | 50ms          | 2ms        | 96% faster     |
| User Profile Lookup         | 30ms          | 1ms        | 97% faster     |

### Cache Strategies

-   **User Cache**: 30 minutes TTL
-   **Game Sessions**: 30 minutes TTL
-   **Leaderboard Global**: No expiration
-   **Leaderboard Daily**: 26 hours TTL
-   **Leaderboard Weekly**: 8 days TTL

## Troubleshooting

### Redis Connection Error

```bash
# Check if Redis is running
docker ps | grep redis

# Restart Redis
docker-compose restart redis

# Check logs
docker-compose logs redis
```

### Database Connection Error

```bash
# Check PostgreSQL
docker ps | grep postgres

# Test connection
psql -h localhost -U postgres -d card_words

# Check logs
docker-compose logs postgres
```

### Application Won't Start

```bash
# Check logs
tail -f app.log

# Verify environment variables
cat .env

# Clean rebuild
./mvnw clean install -DskipTests
```

## Project Structure

```
card-words/
‚îú‚îÄ‚îÄ src/main/java/com/thuanthichlaptrinh/card_words/
‚îÇ   ‚îú‚îÄ‚îÄ common/                 # Constants, enums, exceptions, utils
‚îÇ   ‚îú‚îÄ‚îÄ configuration/          # Spring configs (Security, JWT, Redis, Swagger)
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ domain/            # JPA entities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mapper/            # Entity <-> DTO mappers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service/redis/     # Redis cache services
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ usecase/           # Business logic services
‚îÇ   ‚îú‚îÄ‚îÄ dataprovider/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repository/        # JPA repositories
‚îÇ   ‚îî‚îÄ‚îÄ entrypoint/
‚îÇ       ‚îú‚îÄ‚îÄ dto/               # Request/Response DTOs
‚îÇ       ‚îî‚îÄ‚îÄ rest/              # REST Controllers
‚îú‚îÄ‚îÄ src/main/resources/
‚îÇ   ‚îú‚îÄ‚îÄ db/migration/          # Flyway SQL scripts
‚îÇ   ‚îú‚îÄ‚îÄ data/                  # Initial vocabulary data
‚îÇ   ‚îî‚îÄ‚îÄ application.yml        # Application config
‚îú‚îÄ‚îÄ docs/                      # Documentation
‚îú‚îÄ‚îÄ docker-compose.yml         # Docker services
‚îî‚îÄ‚îÄ Dockerfile                 # App container image
```

## Documentation

Chi tiet trong folder `docs/`:

-   `REDIS_IMPLEMENTATION_PLAN.md` - Ke hoach Redis caching
-   `PHASE_3_LEADERBOARD_COMPLETE.md` - Tai lieu Phase 3
-   `STREAK_FEATURE_COMPLETED.md` - Tai lieu Streak System

---

## üì¶ Backup & Restore Database

### ‚ö†Ô∏è QUAN TR·ªåNG: Data Portability

Khi mang code sang m√°y kh√°c, Docker volumes s·∫Ω **KH√îNG** ƒë∆∞·ª£c transfer t·ª± ƒë·ªông. Database s·∫Ω ch·ªâ c√≥:

-   ‚úÖ **Schema** (tables, constraints) - t·ª´ Flyway migrations
-   ‚úÖ **2 roles** (ROLE_ADMIN, ROLE_USER) - t·ª´ DataInitializer
-   ‚úÖ **2 admin accounts** (admin1@cardwords.com, admin2@cardwords.com) v·ªõi password `Admin@123` - t·ª´ DataInitializer
-   ‚ùå **KH√îNG C√ì** user data, vocab, topics, game_sessions

### üîÑ Backup Database (M√°y hi·ªán t·∫°i)

**Tr√™n m√°y c√≥ data:**

```bash
# Linux/Mac
./backup-database.sh

# Windows
backup-database.bat
```

-   File backup ƒë∆∞·ª£c l∆∞u t·∫°i: `database-backups/card_words_YYYYMMDD_HHMMSS.sql`
-   Script t·ª± ƒë·ªông gi·ªØ 5 b·∫£n backup g·∫ßn nh·∫•t

### üì• Restore Database (M√°y m·ªõi)

**Tr√™n m√°y m·ªõi ho·∫∑c m√°y ch∆∞a c√≥ data:**

```bash
# 1. Start Docker containers
docker-compose up -d

# 2. ƒê·ª£i app kh·ªüi ƒë·ªông xong (check logs)
docker logs -f card-words-app
# Ch·ªù ƒë·∫øn khi th·∫•y: "Started CardWordsApplication"

# 3. Restore database
# Linux/Mac:
./restore-database.sh database-backups/card_words_20250116_120000.sql

# Windows:
restore-database.bat database-backups\card_words_20250116_120000.sql
```

### üí° L∆∞u √Ω khi di chuy·ªÉn sang m√°y kh√°c

1. **Copy c√°c file c·∫ßn thi·∫øt:**

    ```
    üìÅ card-words/
    ‚îú‚îÄ‚îÄ database-backups/         ‚Üê QUAN TR·ªåNG: Copy folder n√†y
    ‚îÇ   ‚îî‚îÄ‚îÄ card_words_*.sql
    ‚îú‚îÄ‚îÄ backup-database.sh        ‚Üê Script backup
    ‚îú‚îÄ‚îÄ restore-database.sh       ‚Üê Script restore
    ‚îú‚îÄ‚îÄ .env                      ‚Üê Environment variables
    ‚îî‚îÄ‚îÄ docker-compose.yml
    ```

2. **Quy tr√¨nh setup tr√™n m√°y m·ªõi:**

    ```bash
    # B∆∞·ªõc 1: Clone code
    git clone <your-repo>
    cd card-words

    # B∆∞·ªõc 2: Copy file backup t·ª´ m√°y c≈© (ho·∫∑c pull t·ª´ Git n·∫øu ƒë√£ commit)
    # database-backups/card_words_*.sql

    # B∆∞·ªõc 3: Start Docker
    docker-compose up -d

    # B∆∞·ªõc 4: ƒê·ª£i app start xong
    docker logs -f card-words-app

    # B∆∞·ªõc 5: Restore database
    ./restore-database.sh database-backups/card_words_*.sql

    # ‚úÖ Done! Database ƒë√£ c√≥ ƒë·∫ßy ƒë·ªß data
    ```

3. **N·∫øu kh√¥ng c√≥ file backup:**

    - Database s·∫Ω r·ªóng (ch·ªâ c√≥ schema v√† 2 admin accounts)
    - C·∫ßn import l·∫°i data t·ª´ PgAdmin ho·∫∑c SQL dump
    - Ho·∫∑c populate data m·ªõi qua API

### üîí B·∫£o m·∫≠t file backup

**KH√îNG commit file backup v√†o Git n·∫øu ch·ª©a:**

-   User passwords (ngay c·∫£ ƒë√£ hash)
-   Sensitive user data (email, phone numbers)
-   Production data

**Khuy·∫øn ngh·ªã:**

-   Add v√†o `.gitignore`:
    ```gitignore
    database-backups/
    *.sql
    ```
-   S·ª≠ d·ª•ng secure storage (AWS S3, Google Drive, BitBucket Artifacts)
-   Encrypt backup files tr∆∞·ªõc khi share

### üìä Docker Volume Management (N√¢ng cao)

**Backup to√†n b·ªô PostgreSQL volume:**

```bash
# Export volume
docker run --rm \
  -v card-words_postgres_data:/data \
  -v $(pwd):/backup \
  alpine tar czf /backup/postgres_volume.tar.gz -C /data .
```

**Restore volume:**

```bash
# Import volume
docker volume create card-words_postgres_data
docker run --rm \
  -v card-words_postgres_data:/data \
  -v $(pwd):/backup \
  alpine tar xzf /backup/postgres_volume.tar.gz -C /data
```

---

-   `GAME_ALGORITHMS_DESIGN.md` - Thuat toan game
-   `FLYWAY_MIGRATION_GUIDE.md` - Huong dan migration DB

## Contributing

1. Fork project
2. Tao branch moi: `git checkout -b feature/amazing-feature`
3. Commit changes: `git commit -m 'feat: Add amazing feature'`
4. Push len branch: `git push origin feature/amazing-feature`
5. Tao Pull Request

## License

MIT License - xem file LICENSE de biet them chi tiet

## Contact

-   **Author**: Ngo Minh Thuan (thuanthichlaptrinh)
-   **Email**: thuanthichlaptrinh@gmail.com
-   **GitHub**: https://github.com/thuanthichlaptrinh/card_words
