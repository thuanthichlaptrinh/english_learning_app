# ğŸ´ Card Words Services - Monorepo

> Monorepo chá»©a táº¥t cáº£ services cá»§a Card Words Platform: Backend API (Spring Boot) vÃ  AI Service (Python FastAPI)

[![Java](https://img.shields.io/badge/Java-17-orange)](https://www.oracle.com/java/)
[![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.2.5-brightgreen)](https://spring.io/projects/spring-boot)
[![Python](https://img.shields.io/badge/Python-3.11-blue)](https://www.python.org/)
[![FastAPI](https://img.shields.io/badge/FastAPI-Latest-009688)](https://fastapi.tiangolo.com/)
[![Docker](https://img.shields.io/badge/Docker-Compose-2496ED)](https://www.docker.com/)

---

## ğŸ“ Cáº¥u trÃºc Monorepo

```
card-words-services/
â”œâ”€â”€ card-words/              # Spring Boot Backend API
â”‚   â”œâ”€â”€ src/                 # Java source code
â”‚   â”œâ”€â”€ pom.xml             # Maven dependencies
â”‚   â””â”€â”€ Dockerfile          # Docker build cho Spring Boot
â”‚
â”œâ”€â”€ card-words-ai/          # Python AI Service
â”‚   â”œâ”€â”€ app/                # FastAPI application
â”‚   â”œâ”€â”€ models/             # LightGBM models
â”‚   â”œâ”€â”€ pyproject.toml      # Poetry dependencies
â”‚   â””â”€â”€ Dockerfile          # Docker build cho Python
â”‚
â”œâ”€â”€ docs/                   # Documentation
â”‚   â”œâ”€â”€ auth/              # Authentication guides
â”‚   â”œâ”€â”€ docker/            # Docker setup guides
â”‚   â”œâ”€â”€ AI/                # AI/ML documentation
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ docker-compose.yml     # âœ¨ SHARED Docker Compose (Táº¤T Cáº¢ SERVICES)
â”œâ”€â”€ .env                   # âœ¨ SHARED Environment Variables
â”œâ”€â”€ .gitignore            # Monorepo gitignore
â””â”€â”€ README.md             # This file
```

---

## ğŸš€ Quick Start

### Prerequisites

-   **Docker Desktop** (hoáº·c Docker Engine + Docker Compose)
-   **Java 17+** (náº¿u cháº¡y local)
-   **Maven 3.9+** (náº¿u build local)
-   **Python 3.11+** (náº¿u cháº¡y AI service local)

### ğŸ³ Cháº¡y táº¥t cáº£ services vá»›i Docker (Recommended)

```bash
# 1. Di chuyá»ƒn vÃ o thÆ° má»¥c root
cd card-words-services

# 2. Start táº¥t cáº£ services
docker-compose up -d

# 3. Xem logs
docker-compose logs -f

# 4. Kiá»ƒm tra status
docker-compose ps
```

**Services sáº½ cháº¡y trÃªn:**

-   ğŸŒ **Spring Boot API**: http://localhost:8080
-   ğŸ¤– **AI Service**: http://localhost:8001
-   ğŸ—„ï¸ **PostgreSQL**: localhost:5433
-   ğŸ”´ **Redis**: localhost:6379
-   ğŸ”§ **PgAdmin**: http://localhost:5050
-   ğŸ“Š **Redis Insight**: http://localhost:5540

---

## ğŸ“¦ Services

### 1ï¸âƒ£ card-words (Spring Boot Backend)

**CÃ´ng nghá»‡:**

-   Spring Boot 3.2.5
-   Java 17
-   PostgreSQL 16
-   Redis 7
-   Spring Security + JWT
-   Google OAuth2
-   Firebase Storage

**Ports:**

-   Application: `8080`
-   Database: `5433` (external)

**Documentation:**

-   API Docs: http://localhost:8080/swagger-ui.html
-   Actuator: http://localhost:8080/actuator

### 2ï¸âƒ£ card-words-ai (Python AI Service)

**CÃ´ng nghá»‡:**

-   Python 3.11
-   FastAPI
-   LightGBM (Machine Learning)
-   PostgreSQL (read-only)
-   Redis (caching)

**Ports:**

-   API: `8001`

**Features:**

-   Smart Vocabulary Review (LightGBM predictions)
-   Redis caching cho performance
-   JWT authentication vá»›i Spring Boot

---

## âš™ï¸ Configuration

### Environment Variables (`.env`)

```env
# Server Ports
SERVER_SPRING_PORT=8080
SERVER_FLASH_PORT=8001

# Database
POSTGRES_DB=card_words
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_password
POSTGRES_EXTERNAL_PORT=5433

# Redis
REDIS_EXTERNAL_PORT=6379
REDIS_AI_DB=1

# JWT
JWT_SECRET=your_jwt_secret

# Email
MAIL_USERNAME=your_email@gmail.com
MAIL_PASSWORD=your_app_password

# Google OAuth2
GOOGLE_OAUTH_CLIENT_ID=your_client_id
GOOGLE_OAUTH_CLIENT_SECRET=your_client_secret

# Firebase
FIREBASE_STORAGE_BUCKET=your_bucket
```

**âš ï¸ LÆ¯U Ã:** File `.env` chá»©a thÃ´ng tin nháº¡y cáº£m, khÃ´ng commit lÃªn Git!

---

## ğŸ”§ Development

### Cháº¡y tá»«ng service riÃªng láº»

#### Spring Boot (card-words)

```bash
cd card-words

# Build
mvn clean package -DskipTests

# Run
mvn spring-boot:run

# Hoáº·c
java -jar target/card-words-0.0.1-SNAPSHOT.jar
```

#### AI Service (card-words-ai)

```bash
cd card-words-ai

# Install dependencies
poetry install

# Run
poetry run uvicorn app.main:app --reload --port 8001
```

### Build Docker Images

```bash
# Build táº¥t cáº£
docker-compose build

# Build tá»«ng service
docker-compose build card-words-api
docker-compose build card-words-ai

# Build vá»›i no cache
docker-compose build --no-cache
```

---

## ğŸ—„ï¸ Database

### Migrations

Database schema Ä‘Æ°á»£c quáº£n lÃ½ bá»Ÿi **Flyway**:

-   Location: `card-words/src/main/resources/db/migration/`
-   Auto-run khi start application

### Backup & Restore

```bash
cd card-words

# Backup
./backup-database.bat   # Windows
./backup-database.sh    # Linux/Mac

# Restore
./restore-database.bat  # Windows
./restore-database.sh   # Linux/Mac
```

Backups Ä‘Æ°á»£c lÆ°u trong: `card-words/database-backups/`

---

## ğŸ§ª Testing

### Spring Boot Tests

```bash
cd card-words
mvn test
```

### AI Service Tests

```bash
cd card-words-ai
poetry run pytest
```

---

## ğŸ“Š Monitoring & Logs

### Xem logs

```bash
# Táº¥t cáº£ services
docker-compose logs -f

# Service cá»¥ thá»ƒ
docker-compose logs -f card-words-api
docker-compose logs -f card-words-ai

# Chá»‰ xem 100 dÃ²ng cuá»‘i
docker-compose logs --tail=100 -f
```

### Health Checks

```bash
# Spring Boot
curl http://localhost:8080/actuator/health

# AI Service
curl http://localhost:8001/health

# Database
docker-compose exec postgres pg_isready -U postgres
```

---

## ğŸ› ï¸ Troubleshooting

### Containers khÃ´ng start

```bash
# Stop táº¥t cáº£
docker-compose down

# XÃ³a volumes (âš ï¸ Máº¤T Dá»® LIá»†U)
docker-compose down -v

# Rebuild vÃ  start láº¡i
docker-compose up -d --build
```

### Port conflicts

```bash
# Kiá»ƒm tra port Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng
netstat -ano | findstr :8080    # Windows
lsof -i :8080                   # Mac/Linux

# Thay Ä‘á»•i port trong .env
SERVER_SPRING_PORT=8081
```

### Database connection failed

```bash
# Kiá»ƒm tra PostgreSQL logs
docker-compose logs postgres

# Test connection
docker-compose exec postgres psql -U postgres -d card_words -c '\dt'
```

---

## ğŸ“š Documentation

Chi tiáº¿t documentation cho tá»«ng module:

-   **Authentication**: [docs/auth/](docs/auth/)
-   **Docker Setup**: [docs/docker/](docs/docker/)
-   **AI/ML**: [docs/AI/](docs/AI/)
-   **API Guides**: [docs/](docs/)

**Migration Guide**: [MIGRATION_GUIDE.md](MIGRATION_GUIDE.md)

---

## ğŸ¤ Contributing

### Git Workflow

```bash
# Táº¡o branch má»›i
git checkout -b feature/your-feature-name

# Commit changes
git add .
git commit -m "feat: your feature description"

# Push
git push origin feature/your-feature-name

# Táº¡o Pull Request trÃªn GitHub
```

### Commit Message Convention

```
feat: thÃªm tÃ­nh nÄƒng má»›i
fix: sá»­a bug
docs: cáº­p nháº­t documentation
refactor: refactor code
test: thÃªm tests
chore: maintenance tasks
```

---

## ğŸ“„ License

[Add your license here]

---

## ğŸ‘¥ Team

-   **Backend Developer**: [Your Name]
-   **AI/ML Engineer**: [Your Name]

---

## ğŸ“ Support

Náº¿u gáº·p váº¥n Ä‘á», vui lÃ²ng:

1. Kiá»ƒm tra [Troubleshooting](#-troubleshooting)
2. Xem [Documentation](docs/)
3. Táº¡o [GitHub Issue](https://github.com/thuanthichlaptrinh/card_words_services/issues)

---

**Made with â¤ï¸ by Card Words Team**
